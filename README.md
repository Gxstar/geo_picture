# 图片GPS信息添加工具

一个功能强大的图片GPS信息添加工具，支持单张和批量图片处理，提供多种GPS信息输入方式，包括手动输入、地图选择和地址查询。

## 功能特性

### 图片选择
- ✅ 支持单张图片选择
- ✅ 支持批量图片选择
- ✅ 图片预览功能
- ✅ 现有GPS信息检测

### GPS信息输入
- ✅ 手动输入经纬度
- ✅ 在地图上点击选择位置
- ✅ 通过地址查询获取经纬度
- ✅ 支持多种地图瓦片源

### 批量处理
- ✅ 支持批量添加GPS信息
- ✅ 实时进度显示
- ✅ 处理结果统计

### 配置管理
- ✅ API设置功能
- ✅ 本地配置保存
- ✅ 环境变量支持

### 其他特性
- ✅ 支持多种图片格式（JPEG、HEIC/HEIF、AVIF等）
- ✅ 覆盖原图或生成新文件
- ✅ 现代化的UI设计
- ✅ 响应式布局
- ✅ 友好的错误提示

## 技术栈

### 后端
- **Python**：主要开发语言
- **pywebview**：桌面应用框架
- **PIL**：图片处理
- **exifread**：读取EXIF信息
- **piexif**：写入EXIF信息
- **requests**：API调用

### 前端
- **HTML5**：页面结构
- **Tailwind CSS**：样式框架
- **JavaScript**：交互逻辑
- **Leaflet**：地图库

### 地址查询API
- **apihz.cn**：提供地址转经纬度服务

## 安装说明

### 环境要求
- Python 3.10+
- pip 或 uv 包管理器

### 安装步骤

1. 克隆或下载项目

2. 安装依赖
   ```bash
   # 使用uv（推荐）
   uv install
   
   # 或使用pip
   pip install -r requirements.txt
   ```

3. 配置API（可选）
   - 在项目根目录创建`.env`文件
   - 添加以下内容：
     ```
     API_ID=your_api_id
     API_KEY=your_api_key
     ```
   - 或在应用中通过设置界面配置

4. 运行应用
   ```bash
   python main.py
   ```

## 使用方法

### 1. 选择图片
- 点击「选择单张图片」或「批量选择图片」按钮
- 在文件选择对话框中选择图片
- 查看图片预览和现有GPS信息

### 2. 设置GPS信息
- **手动输入**：在输入框中直接输入经纬度
- **地图选择**：点击地图上的位置，自动填充经纬度
- **地址查询**：输入地址，点击「查询」按钮获取经纬度

### 3. 添加GPS信息
- 选择是否覆盖原图
- 点击「添加GPS信息」或「批量添加GPS信息」按钮
- 等待处理完成
- 查看处理结果

### 4. 配置API
- 点击左下角的设置图标
- 输入API ID和API Key
- 点击「保存设置」按钮

## 项目结构

```
图片GPS信息添加工具/
├── geo_picture/           # 核心功能模块
│   ├── __init__.py        # 包初始化文件
│   └── geo_processor.py   # 图片GPS处理核心逻辑
├── index.html            # 前端页面
├── main.py               # 应用入口
├── pyproject.toml        # 项目配置
├── uv.lock               # 依赖锁定文件
└── README.md             # 项目说明文档
```

## 核心功能说明

### 图片处理流程
1. 读取图片文件
2. 解析现有EXIF信息
3. 添加或更新GPS信息
4. 保存图片，保留原始画质

### GPS信息格式
- 支持度分秒格式和十进制格式
- 自动处理GPS方向（N/S/E/W）
- 完整保存GPS相关EXIF字段

### 地址查询
- 调用apihz.cn API
- 支持模糊查询
- 返回精确的经纬度坐标

## 打包说明

使用Nuitka打包成可执行文件：

```bash
python -m nuitka --onefile --output-dir=dist --include-data-file=index.html=index.html --exclude-data-file=.env main.py
```

## 许可证

MIT License

## 贡献

欢迎提交Issue和Pull Request！

## 联系方式

如有问题或建议，欢迎通过以下方式联系：
- 提交GitHub Issue
- 发送邮件至开发者邮箱

## 更新日志

### v1.0.0
- 初始版本
- 支持单张和批量图片处理
- 支持手动输入、地图选择和地址查询
- 现代化的UI设计
- API设置功能

### v1.1.0
- 优化图片处理性能
- 改进地图交互体验
- 增强错误处理
- 优化打包配置

## 致谢

- 感谢apihz.cn提供的地址查询API
- 感谢所有开源库的开发者
- 感谢用户的反馈和建议

---

**Enjoy using 图片GPS信息添加工具！** 📸🌍